{%extends 'base.html'%}

{%block content%}
<form>
<div>
      <div class="row">
       <div class="input-field col s6">
          {{form.titulo_anuncio}}
        </div>
        <div class="input-field col s6">
          {{form.descripcion_anuncio}}
        </div>
        <div class="input-field col s6">
          {{form.precio}}
        </div>
        <div class="input-field col s6">
          {{form.Moneda}}
        </div>
        <div>
          {{form.categoria.label_tag}}
          {{form.categoria}}
        </div>
       <div>
          {{form.subcategoria_relacion.label_tag}}
          {{form.subcategoria_relacion}}
       </div>
    </div>
  {% if form.errors %}
    {% for field in form %}
        {% for error in field.errors %}
            <div class="alert alert-danger">
                <strong>{{ error|escape }}</strong>
            </div>
        {% endfor %}
    {% endfor %}
    {% for error in form.non_field_errors %}
        <div class="alert alert-danger">
            <strong>{{ error|escape }}</strong>
        </div>
    {% endfor %}
{% endif %}
</div>
</form>
<!--<form  id="formulario" method="POST" class="post-form">{% csrf_token %}
  {{form.as_p}}
  <p><input type="submit" value="Guardar"></p>
</form>-->

<script type="text/javascript">
 $(document).ready(function() {
    $('select').material_select();
  });

  $(document).ready(function(){
    $("#id_categoria").on("change", getSubcategoria);
  });

  function getSubcategoria() {
    var categoriaId = $("#id_categoria").val();
    if (categoriaId) {
      $("#id_subcategoria_relacion").html("");
      var request = $.ajax({
        type: "GET",
        url: "{%url 'product:get_subcategoria' %}",
        data: {
          "categoria_id":categoriaId,
        },
      });
      request.done(function (response) {
        //opciones
        $("#id_subcategoria_relacion").html(response.subcategorias);
        $("id_subcategoria_relacion").trigger("change");
      });
    } else {
      $("#id_subcategoria_relacion").html("<option value='' selected='selected'></option>");
      $("#id_subcategoria_relacion").trigger("change")
    }
  }
</script>

{%endblock content%}
