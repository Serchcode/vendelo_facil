{%extends 'base.html'%}
{% block titulo %}Anuncio{% endblock titulo %}
{%block content%}

<div class="row">
    <form class="col s12" method="POST">
      {% csrf_token %}
      <div class="row">
        <div class="input-field col s12">
          {{form.titulo_anuncio}}
        </div>
      </div>
      <div class="row">
        <div class="input-field col s12">
          {{form.descripcion_anuncio}}
        </div>
      </div>
      <div class="row">
        <div class="input-field col s6">
          {{form.precio}}
        </div>
        <div class="col s6">
          {{form.Moneda}}
        </div>
      </div>
      <div class="row">
        <div class=" col s6">
          {{form.categoria.label_tag}}
          {{form.categoria}}
        </div>
        <div class="col s6">
          {{form.subcategoria_relacion.label_tag}}
          {{form.subcategoria_relacion}}
        </div>
      </div>
      <div class="row">
        <div class="col s4">
          {{form.imagen_principal}}
        </div>
        <div class="col s4">
          {{form.imagen_secundaria}}
        </div>
        <div class="col s4">
          {{form.imagen_terciaria}}
        </div>
      </div>
      <input type="submit" value="Guardar">
  </form>
</div>
<script type="text/javascript">
  $(document).ready(function(){
    $("#id_categoria").on("change", getSubcategoria);
    $('select').material_select();
  });

  function getSubcategoria() {
    var categoriaId = $("#id_categoria").val();
    if (categoriaId) {
      $("#id_subcategoria_relacion").html("");
      var request = $.ajax({
        type: "GET",
        url: "{%url 'product:get_subcategoria' %}",
        data: {
          "categoria_id":categoriaId,
        },
      });
      request.done(function (response) {
        //Rsultados del select
        $("#id_subcategoria_relacion").html(response.subcategorias);
        $("#id_subcategoria_relacion").trigger("change");
        $(".input.select-dropdown").html(response.subcategorias);
        $(".input.select-dropdown").trigger("change");
      });
    } else {
      $("#id_subcategoria_relacion").html("");
      $("#id_subcategoria_relacion").trigger("change")
    }
  }
</script>
{%endblock content%}
